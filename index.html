<!DOCTYPE html>
<!-- Defaulting to English, will be changed by JS -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title will be set by JS based on language -->
    <title>Friendship Spark</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Mochiy+Pop+One&family=Baloo+Bhai+2:wght@400;500;600;700&display=swap');

        :root {
            --primary-color: #ff6347; /* Tomato */
            --secondary-color: #4682b4; /* Steel Blue */
            --accent-color: #ffd700; /* Gold */
            --text-color: #2c3e50; /* Midnight Blue */
            --bg-color-light: #fff;
            --bg-color-soft: #f4f6f8;
            --border-radius: 18px;
            --box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
            --font-primary: 'Poppins', sans-serif;
            --font-headings: 'Mochiy Pop One', 'Baloo Bhai 2', cursive;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-primary);
            color: var(--text-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            padding: 20px 15px; /* Adjusted padding */
            text-align: center;
            overflow-x: hidden; /* Prevent horizontal scroll */
            overflow-y: auto; /* Allow vertical scroll */
            background: linear-gradient(120deg, #f6d365 0%, #fda085 100%);
            position: relative;
            transition: background 0.5s ease;
        }

        @keyframes dynamicGradient {
            0%{background-position:0% 50%}
            50%{background-position:100% 50%}
            100%{background-position:0% 50%}
        }
        body.theme-cool {
            background: linear-gradient(-45deg, #23a6d5, #23d5ab, #60efff, #007991);
            background-size: 400% 400%;
            animation: dynamicGradient 18s ease infinite;
        }
        body.theme-warm {
             background: linear-gradient(-45deg, #ee7752, #e73c7e, #ff7f50, #f08080);
            background-size: 400% 400%;
            animation: dynamicGradient 18s ease infinite;
        }


        /* Floating Emojis - Friendship Themed */
        .floating-emojis {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: 0;
            pointer-events: none;
        }

        .emoji-float {
            position: absolute;
            font-size: 1.2rem; /* Base size */
            animation: floatUp 20s linear infinite;
            opacity: 0;
            /* Emojis will be set via JS */
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        .container {
            background-color: var(--bg-color-light);
            padding: clamp(25px, 5vw, 40px); /* Responsive padding */
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            max-width: 600px;
            width: 100%;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
            border-top: 7px solid;
            animation: slideInUp 0.7s cubic-bezier(0.165, 0.84, 0.44, 1) forwards;
        }
        .form-container { border-top-color: var(--primary-color); }
        .received-message-container {
            border-top-color: var(--secondary-color);
            background-color: #eaf2f8; /* Softer blue tint */
        }

        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(60px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .received-message-container h2 { color: var(--secondary-color) !important; }

        h1, h2, h3 {
            font-family: var(--font-headings);
            font-weight: normal; /* Mochiy Pop One is bold by default */
            line-height: 1.25;
            letter-spacing: 0.5px;
            margin-bottom: 18px;
        }
        h1 { color: var(--primary-color); font-size: clamp(2em, 6vw, 2.8em); }
        h2 { color: var(--secondary-color); font-size: clamp(1.7em, 5vw, 2.2em); }

        p.intro, p.message-text {
            font-size: clamp(1em, 2.5vw, 1.15em);
            color: var(--text-color);
            margin-bottom: 22px;
            line-height: 1.7;
            font-weight: 400;
        }
        p.message-text strong {
            font-weight: 600;
            color: var(--primary-color);
        }
        .received-message-container p.message-text strong {
            color: var(--secondary-color);
        }

        .input-group {
            margin-bottom: 22px;
            text-align: left;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #555;
            font-size: clamp(0.9em, 2.2vw, 1em);
        }

        input[type="text"] {
            width: 100%;
            padding: 15px 20px;
            border: 2px solid #dfe4ea;
            border-radius: calc(var(--border-radius) - 4px);
            font-size: clamp(0.95em, 2.3vw, 1.05em);
            font-family: var(--font-primary);
            font-weight: 500;
            transition: all 0.25s ease-in-out;
            background-color: var(--bg-color-soft);
        }
        input[type="text"]::placeholder { color: #95a5a6; font-weight: 400; }
        input[type="text"]:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 4px rgba(255, 99, 71, 0.15);
            outline: none;
            background-color: var(--bg-color-light);
        }

        button#shareButton {
            background: linear-gradient(45deg, var(--primary-color), #ff7f50);
            color: white;
            border: none;
            padding: 16px 30px;
            border-radius: var(--border-radius);
            font-size: clamp(1em, 2.8vw, 1.15em);
            font-family: var(--font-headings);
            font-weight: normal;
            cursor: pointer;
            transition: all 0.25s ease-in-out;
            width: 100%;
            text-transform: capitalize;
            letter-spacing: 0.8px;
            margin-top: 10px;
            box-shadow: 0 6px 20px rgba(255, 99, 71, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        button#shareButton .icon { font-size: 1.2em; }
        button#shareButton:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 10px 30px rgba(255, 99, 71, 0.4);
        }
        button#shareButton:active {
            transform: translateY(-1px) scale(0.99);
            box-shadow: 0 3px 15px rgba(255, 99, 71, 0.25);
        }

        .footer-note {
            margin-top: 25px;
            font-size: clamp(0.85em, 2vw, 0.95em);
            color: var(--text-color);
            opacity: 0.8;
            font-weight: 500;
        }
        .lang-switcher {
            margin-top: 15px; font-size: 0.8em;
        }
        .lang-switcher button {
            background: none; border: 1px solid var(--primary-color); color: var(--primary-color);
            padding: 5px 10px; margin: 0 5px; border-radius: 5px; cursor: pointer;
        }
         .lang-switcher button.active { background: var(--primary-color); color: white; }

        .received-message-container .heart {
            font-size: clamp(2.5em, 8vw, 3.5em);
            margin: 15px 0 20px;
            animation: heartPop 1.5s infinite cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: inline-block;
        }
        @keyframes heartPop {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(0.8) rotate(-5deg); }
            50% { transform: scale(1.2) rotate(5deg); }
            75% { transform: scale(0.9) rotate(0deg); }
        }
    </style>
</head>
<body>
    <div class="floating-emojis" id="floatingEmojisContainer">
        <!-- Emojis will be added here by JavaScript -->
    </div>

    <div id="receivedMessageDisplay" class="container received-message-container" style="display: none;">
        <h2 data-lang-key="receivedTitle">🎉 A Surprise For You! 🎉</h2>
        <p id="personalizedMessage" class="message-text"></p>
        <div class="heart">💖</div>
        <p class="message-text" style="font-weight: 500;" data-lang-key="receivedHint">Loved this? You can make someone else smile too!</p>
    </div>

    <div class="container form-container">
        <h1 data-lang-key="mainTitle">✨ Spark a Friendship Smile ✨</h1>
        <p class="intro" data-lang-key="mainIntro">Send a heartfelt message to your dear friend and brighten their day!</p>

        <div class="input-group">
            <label for="senderName" data-lang-key="yourNameLabel">Your Awesome Name:</label>
            <input type="text" id="senderName" data-lang-placeholder-key="yourNamePlaceholder" placeholder="e.g., Rockstar, Angel...">
        </div>

        <div class="input-group">
            <label for="friendName" data-lang-key="friendNameLabel">Your Best Friend's Name:</label>
            <input type="text" id="friendName" data-lang-placeholder-key="friendNamePlaceholder" placeholder="e.g., Buddy, Partner...">
        </div>

        <button id="shareButton">
            <span class="icon">💌</span> <span data-lang-key="shareButtonText">Create & Share Link!</span>
        </button>

        <p class="footer-note" data-lang-key="footerText">Friendship is a treasure! <span class="emoji">🌟</span></p>
        <div class="lang-switcher">
            <span data-lang-key="languageLabel">Language:</span>
            <button id="langEn" data-lang="en">EN</button>
            <button id="langHi" data-lang="hi">हि</button>
        </div>
    </div>

    <script>
        // --- LANGUAGE MANAGEMENT ---
        const translations = {
            en: {
                docTitle: "Friendship Spark ✨",
                receivedTitle: "🎉 A Surprise For You! 🎉",
                receivedHint: "Loved this? You can make someone else smile too!",
                mainTitle: "✨ Spark a Friendship Smile ✨",
                mainIntro: "Send a heartfelt message to your dear friend and brighten their day!",
                yourNameLabel: "Your Awesome Name:",
                yourNamePlaceholder: "e.g., Rockstar, Angel...",
                friendNameLabel: "Your Best Friend's Name:",
                friendNamePlaceholder: "e.g., Buddy, Partner...",
                shareButtonText: "Create & Share Link!",
                footerText: "Friendship is a treasure! 🌟",
                alertEnterNames: "Hey buddy! Please enter your name and your friend's name to create the magic link! 😉",
                alertShareError: "Oops! Couldn't share the link. Maybe you cancelled? 🙁 Try again or copy manually.",
                alertClipboardSuccess: "Your browser doesn't support direct sharing. 🤔 But no worries, the link and message are copied to your clipboard! Share it manually. 👍",
                alertClipboardError: "Direct sharing isn't supported & copying failed. 😢 Please copy the link manually:\n\n",
                shareMessagePrefix: "👋 Hey",
                shareMessageSuffix: "! Your awesome friend",
                shareMessageMiddle: "has sent you a heartfelt surprise! 💌 Open the link to see: ",
                personalizedMessageHey: "Hey",
                personalizedMessageDearFriend: ", my dear friend!",
                personalizedMessageContent1: "Guess what? Your buddy",
                personalizedMessageContent2: "is thinking of you and sending a big virtual hug! 🤗 All those fun times, crazy laughs, and endless chats... they make life so much better. Just wanted to remind you how special you are and how much your friendship means.",
                personalizedMessageContent3: "Stay amazing, and let's catch up soon! Loads of love! 💖",
                languageLabel: "Language:",
                themeToggleText: "Toggle Theme"
            },
            hi: {
                docTitle: " दोस्ती की चमक ✨",
                receivedTitle: "🎉 आपके लिए एक सरप्राइज! 🎉",
                receivedHint: "यह पसंद आया? आप भी किसी और को खुश कर सकते हैं!",
                mainTitle: "✨ दोस्ती की मुस्कान जगाओ ✨",
                mainIntro: "अपने प्यारे दोस्त को दिल से लिखा यह संदेश भेजें और उनका दिन रोशन करें!",
                yourNameLabel: "आपका प्यारा नाम:",
                yourNamePlaceholder: "जैसे: रॉकस्टार, एंजेल...",
                friendNameLabel: "आपके सबसे अच्छे दोस्त का नाम:",
                friendNamePlaceholder: "जैसे: बडी, पार्टनर...",
                shareButtonText: "लिंक बनाएं और शेयर करें!",
                footerText: "दोस्ती एक खजाना है! 🌟",
                alertEnterNames: "ऐ दोस्त! कृपया अपना और अपने दोस्त का नाम डालें ताकि जादुई लिंक बन सके! 😉",
                alertShareError: "ओह! लिंक शेयर नहीं हो सका। शायद आपने रद्द कर दिया? 🙁 फिर से प्रयास करें या मैन्युअल रूप से कॉपी करें।",
                alertClipboardSuccess: "आपका ब्राउज़र डायरेक्ट शेयरिंग सपोर्ट नहीं करता। 🤔 पर कोई बात नहीं, लिंक और मैसेज क्लिपबोर्ड पर कॉपी हो गए हैं! इसे मैन्युअल रूप से शेयर करें। 👍",
                alertClipboardError: "डायरेक्ट शेयरिंग समर्थित नहीं है और कॉपी भी विफल रही। 😢 कृपया लिंक मैन्युअल रूप से कॉपी करें:\n\n",
                shareMessagePrefix: "👋 नमस्ते",
                shareMessageSuffix: "! आपके प्यारे दोस्त",
                shareMessageMiddle: "ने आपके लिए दिल से एक सरप्राइज भेजा है! 💌 क्या है, यह देखने के लिए लिंक खोलें: ",
                personalizedMessageHey: "नमस्ते",
                personalizedMessageDearFriend: ", मेरे प्यारे दोस्त!",
                personalizedMessageContent1: "पता है क्या? आपका दोस्त",
                personalizedMessageContent2: "आपको याद कर रहा है और एक बड़ा वर्चुअल हग भेज रहा है! 🤗 वो सारे मज़ेदार पल, वो पागलपन वाली हँसी, और वो अंतहीन बातें... ये सब ज़िंदगी को कितना बेहतर बनाते हैं। बस तुम्हें याद दिलाना चाहता था कि तुम कितने खास हो और तुम्हारी दोस्ती कितनी मायने रखती है।",
                personalizedMessageContent3: "हमेशा ऐसे ही रहना, और जल्द ही मिलते हैं! ढेर सारा प्यार! 💖",
                languageLabel: "भाषा:",
                themeToggleText: "थीम बदलें"
            }
        };

        let currentLang = 'en'; // Default

        function setLanguage(lang) {
            if (!translations[lang]) lang = 'en'; // Fallback to English
            currentLang = lang;
            document.documentElement.lang = lang;
            document.title = translations[lang].docTitle;

            document.querySelectorAll('[data-lang-key]').forEach(el => {
                const key = el.getAttribute('data-lang-key');
                if (translations[lang][key]) {
                    el.textContent = translations[lang][key];
                }
            });
            document.querySelectorAll('[data-lang-placeholder-key]').forEach(el => {
                const key = el.getAttribute('data-lang-placeholder-key');
                if (translations[lang][key]) {
                    el.placeholder = translations[lang][key];
                }
            });
            // Update active language button
            document.getElementById('langEn').classList.toggle('active', lang === 'en');
            document.getElementById('langHi').classList.toggle('active', lang === 'hi');
        }

        // --- UI ELEMENTS & LOGIC ---
        const receivedMessageDisplay = document.getElementById('receivedMessageDisplay');
        const personalizedMessageElement = document.getElementById('personalizedMessage');
        const senderNameInput = document.getElementById('senderName');
        const friendNameInput = document.getElementById('friendName');
        const shareButton = document.getElementById('shareButton');
        const floatingEmojisContainer = document.getElementById('floatingEmojisContainer');

        const friendshipEmojis = ['💖', '✨', '🎉', '🎈', '😊', '😂', '👍', '💯', '🌟', '☀️', '🤝', '🤗', '🥳', '🤩'];

        function createFloatingEmoji() {
            const emojiSpan = document.createElement('span');
            emojiSpan.classList.add('emoji-float');
            emojiSpan.textContent = friendshipEmojis[Math.floor(Math.random() * friendshipEmojis.length)];
            emojiSpan.style.left = Math.random() * 100 + 'vw';
            emojiSpan.style.fontSize = (Math.random() * 1 + 0.8) + 'rem'; // Size between 0.8rem and 1.8rem
            emojiSpan.style.animationDuration = (Math.random() * 10 + 15) + 's'; // Duration 15-25s
            emojiSpan.style.animationDelay = Math.random() * 5 + 's'; // Delay up to 5s
            floatingEmojisContainer.appendChild(emojiSpan);

            // Remove emoji after animation to prevent too many elements
            setTimeout(() => {
                emojiSpan.remove();
            }, parseFloat(emojiSpan.style.animationDuration) * 1000 + parseFloat(emojiSpan.style.animationDelay) * 1000);
        }

        // Create initial batch of emojis and then periodically
        for (let i = 0; i < 15; i++) createFloatingEmoji(); // Initial
        setInterval(createFloatingEmoji, 2000); // Add one every 2 seconds


        function getUrlParameter(name) {
            name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
            const regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
            const results = regex.exec(location.search);
            return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
        }
        
        function applyRandomTheme() {
            const themes = ['theme-cool', 'theme-warm', '']; // Add more or leave empty for default
            const randomTheme = themes[Math.floor(Math.random() * themes.length)];
            document.body.className = ''; // Clear existing theme classes
            if (randomTheme) {
                document.body.classList.add(randomTheme);
            }
        }

        window.addEventListener('DOMContentLoaded', () => {
            // Language detection
            const userLang = navigator.language || navigator.userLanguage; // "en-US", "hi-IN" etc.
            if (userLang.startsWith('hi')) {
                setLanguage('hi');
            } else {
                setLanguage('en');
            }
            
            applyRandomTheme(); // Apply a random theme on load

            const toName = getUrlParameter('to');
            const fromName = getUrlParameter('from');
            const langParam = getUrlParameter('lang'); // Check if lang is in URL

            if (langParam && translations[langParam]) { // If lang in URL, override browser lang
                setLanguage(langParam);
            }


            if (toName && fromName) {
                const T = translations[currentLang];
                personalizedMessageElement.innerHTML = `
                    ${T.personalizedMessageHey} <strong>${toName}</strong>${T.personalizedMessageDearFriend}<br><br>
                    ${T.personalizedMessageContent1} <strong>${fromName}</strong> ${T.personalizedMessageContent2}<br><br>
                    ${T.personalizedMessageContent3}`;
                receivedMessageDisplay.style.display = 'block';
                const receivedMsgTop = receivedMessageDisplay.getBoundingClientRect().top + window.pageYOffset - 60;
                window.scrollTo({ top: receivedMsgTop, behavior: 'smooth' });
            }
            // Form is always visible
        });

        document.getElementById('langEn').addEventListener('click', () => setLanguage('en'));
        document.getElementById('langHi').
